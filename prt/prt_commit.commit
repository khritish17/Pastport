0040import0os1180import0diff_algorithm1as2da32100import0file_translator1as2ft3抖4380import0reconstructor1as2rc3440class0prt_commit:15300抖0抖1抖2抖3def4__init__(self,5location6=7"",8message9=10"Untitled11Commit")12->13None:146440抖0抖1抖2抖3抖4抖5抖6抖7#8the9work10of11the12commit13file14is15to16reconstructs17the18old19file20抖217440抖0抖1抖2抖3抖4抖5抖6抖7#8and9sends10it11along12the13new14file15to16diff_algo17for18commit19data20creation218260抖0抖1抖2抖3抖4抖5抖6抖7self.location8=9self.location10=11os.path.abspath(location)129220抖0抖1抖2抖3抖4抖5抖6抖7self.message8=9message1010280抖0抖1抖2抖3抖4抖5抖6抖7#8get9the10directory11name12抖1311220抖0抖1抖2抖3抖4抖5抖6抖7self.directory_name8=9self.location.split("\\")[-1]10120013260抖0抖1抖2抖3抖4抖5抖6抖7#8tracking9file10location11抖1214280抖0抖1抖2抖3抖4抖5抖6抖7self.tracking_file_location8抖9=10self.location11+12"/prt/{}.track".format(self.directory_name.lower())1315180抖0抖1抖2抖3抖4抖5抖6抖7try:816300抖0抖1抖2抖3抖4抖5抖6抖7抖8抖9抖10抖11os.listdir(self.location12+13"/prt/")1417180抖0抖1抖2抖3抖4抖5抖6抖7except:818320抖0抖1抖2抖3抖4抖5抖6抖7抖8抖9抖10抖11print("Pastport12not13been14initialized")1519260抖0抖1抖2抖3抖4抖5抖6抖7抖8抖9抖10抖11exit()1220180抖0抖1抖2抖3抖4抖5抖6抖7抖821320抖0抖1抖2抖3抖4抖5抖6抖7#8first9read10the11lines12in13tracking14file1522240抖0抖1抖2抖3抖4抖5抖6抖7tracking_file8=9open(self.tracking_file_location,10'r')1123220抖0抖1抖2抖3抖4抖5抖6抖7tracking_lines8=9tracking_file.readlines()1024180抖0抖1抖2抖3抖4抖5抖6抖7tracking_file.close()825200抖0抖1抖2抖3抖4抖5抖6抖7#8self.commit('old.txt')9260027220抖0抖1抖2抖3抖4抖5抖6抖7directory_list8=9os.listdir(self.location)1028220抖0抖1抖2抖3抖4抖5抖6抖7file_list8=9[]1029240抖0抖1抖2抖3抖4抖5抖6抖7for8file_dir9in10directory_list:1130280抖0抖1抖2抖3抖4抖5抖6抖7抖8抖9抖10抖11if12os.path.isfile(file_dir):1331340抖0抖1抖2抖3抖4抖5抖6抖7抖8抖9抖10抖11抖12抖13抖14抖15file_list.append(file_dir)16320033240抖0抖1抖2抖3抖4抖5抖6抖7if8len(tracking_lines)9==100:1134340抖0抖1抖2抖3抖4抖5抖6抖7抖8抖9抖10抖11#12Initiate13cold14start15commit1635320抖0抖1抖2抖3抖4抖5抖6抖7抖8抖9抖10抖11tracking_file12=13open(self.tracking_file_location,14'w')1536260抖0抖1抖2抖3抖4抖5抖6抖7抖8抖9抖10抖11tracking_file.write("0\u00b6")12370038320抖0抖1抖2抖3抖4抖5抖6抖7抖8抖9抖10抖11for12i13in14range(len(file_list)):1539380抖0抖1抖2抖3抖4抖5抖6抖7抖8抖9抖10抖11抖12抖13抖14抖15file16=17file_list[i]1840400抖0抖1抖2抖3抖4抖5抖6抖7抖8抖9抖10抖11抖12抖13抖14抖15self.cold_commit(file=16file,17commit_number=180)1941440抖0抖1抖2抖3抖4抖5抖6抖7抖8抖9抖10抖11抖12抖13抖14抖15if16i17!=18len(file_list)19-201:2142420抖0抖1抖2抖3抖4抖5抖6抖7抖8抖9抖10抖11抖12抖13抖14抖15抖16抖17抖18抖19tracking_file.write("{},".format(file))2043340抖0抖1抖2抖3抖4抖5抖6抖7抖8抖9抖10抖11抖12抖13抖14抖15else:1644420抖0抖1抖2抖3抖4抖5抖6抖7抖8抖9抖10抖11抖12抖13抖14抖15抖16抖17抖18抖19tracking_file.write("{}\n".format(file))2045260抖0抖1抖2抖3抖4抖5抖6抖7抖8抖9抖10抖11tracking_file.close()1246180抖0抖1抖2抖3抖4抖5抖6抖7else:847500抖0抖1抖2抖3抖4抖5抖6抖7抖8抖9抖10抖11#12Initiate13normal14commit15for16tracked17files18and19cold20commit21for22untracked23files2448320抖0抖1抖2抖3抖4抖5抖6抖7抖8抖9抖10抖11tracking_file12=13open(self.tracking_file_location,14'r')1549300抖0抖1抖2抖3抖4抖5抖6抖7抖8抖9抖10抖11tracking_lines12=13tracking_file.readlines()1450300抖0抖1抖2抖3抖4抖5抖6抖7抖8抖9抖10抖11latest_tracking_entry12=13tracking_lines[-1].split('\u00b6')1451300抖0抖1抖2抖3抖4抖5抖6抖7抖8抖9抖10抖11commit_number12=13int(latest_tracking_entry[0])1452300抖0抖1抖2抖3抖4抖5抖6抖7抖8抖9抖10抖11tracked_files12=13latest_tracking_entry[1].rstrip('\n').split(",")1453260抖0抖1抖2抖3抖4抖5抖6抖7抖8抖9抖10抖11tracking_file.close()1254260抖0抖1抖2抖3抖4抖5抖6抖7抖8抖9抖10抖11抖1255320抖0抖1抖2抖3抖4抖5抖6抖7抖8抖9抖10抖11tracking_file12=13open(self.tracking_file_location,14'a')1556300抖0抖1抖2抖3抖4抖5抖6抖7抖8抖9抖10抖11tracking_file.write("{}\u00b6".format(commit_number12+131))1457320抖0抖1抖2抖3抖4抖5抖6抖7抖8抖9抖10抖11for12i13in14range(len(file_list)):1558380抖0抖1抖2抖3抖4抖5抖6抖7抖8抖9抖10抖11抖12抖13抖14抖15file16=17file_list[i]1859400抖0抖1抖2抖3抖4抖5抖6抖7抖8抖9抖10抖11抖12抖13抖14抖15if16file17in18tracked_files:1960520抖0抖1抖2抖3抖4抖5抖6抖7抖8抖9抖10抖11抖12抖13抖14抖15抖16抖17抖18抖19self.commit(file=20file,21commit_number=22commit_number23+241)2561340抖0抖1抖2抖3抖4抖5抖6抖7抖8抖9抖10抖11抖12抖13抖14抖15else:1662520抖0抖1抖2抖3抖4抖5抖6抖7抖8抖9抖10抖11抖12抖13抖14抖15抖16抖17抖18抖19self.cold_commit(file=20file,21commit_number=22commit_number23+241)2563440抖0抖1抖2抖3抖4抖5抖6抖7抖8抖9抖10抖11抖12抖13抖14抖15if16i17!=18len(file_list)19-201:2164420抖0抖1抖2抖3抖4抖5抖6抖7抖8抖9抖10抖11抖12抖13抖14抖15抖16抖17抖18抖19tracking_file.write("{},".format(file))2065340抖0抖1抖2抖3抖4抖5抖6抖7抖8抖9抖10抖11抖12抖13抖14抖15else:1666420抖0抖1抖2抖3抖4抖5抖6抖7抖8抖9抖10抖11抖12抖13抖14抖15抖16抖17抖18抖19tracking_file.write("{}\n".format(file))2067260抖0抖1抖2抖3抖4抖5抖6抖7抖8抖9抖10抖11tracking_file.close()12680069160抖0抖1抖2抖3def4commit(self,5file,6commit_number):770220抖0抖1抖2抖3抖4抖5抖6抖7file_name8=9file.split('.')[0]1071280抖0抖1抖2抖3抖4抖5抖6抖7#8generate9the10old11file,12抖1372280抖0抖1抖2抖3抖4抖5抖6抖7initial_commit_data8=9ft.read_commit(self.location10+11"/prt/{}.commit".format(file_name),120)1373280抖0抖1抖2抖3抖4抖5抖6抖7old_file8=9open(self.location10+11"/{}.temp".format(file_name),12'w')1374180抖0抖1抖2抖3抖4抖5抖6抖7old_file.close()875300抖0抖1抖2抖3抖4抖5抖6抖7rc.reconstuction(self.location8+9"/{}.temp".format(file_name),10initial_commit_data,11self.location12+13"/{}.old".format(file_name))1476220抖0抖1抖2抖3抖4抖5抖6抖7os.remove(self.location8+9"/{}.temp".format(file_name))1077180抖0抖1抖2抖3抖4抖5抖6抖7抖878440抖0抖1抖2抖3抖4抖5抖6抖7#8send9it10to11diff_algorithm12along13with14new15file,16get17the18commit19data20抖2179320抖0抖1抖2抖3抖4抖5抖6抖7commit_data8=9da.diff_algorithm(self.location10+11"/{}.old".format(file_name),12self.location13+14"/{}".format(file))1580220抖0抖1抖2抖3抖4抖5抖6抖7os.remove(self.location8+9"/{}.old".format(file_name))1081180抖0抖1抖2抖3抖4抖5抖6抖7抖882280抖0抖1抖2抖3抖4抖5抖6抖7ft.write_commit(self.location8+9"/prt/{}.commit".format(file_name),10commit_data,11commit_number,12self.message)1383100抖0抖1抖2抖3抖484160抖0抖1抖2抖3def4cold_commit(self,5file,6commit_number):785220抖0抖1抖2抖3抖4抖5抖6抖7file_name8=9file.split('.')[0]1086280抖0抖1抖2抖3抖4抖5抖6抖7old_file8=9open(self.location10+11"/{}.old".format(file_name),12'w')1387180抖0抖1抖2抖3抖4抖5抖6抖7old_file.close()888320抖0抖1抖2抖3抖4抖5抖6抖7commit_data8=9da.diff_algorithm(self.location10+11"/{}.old".format(file_name),12self.location13+"/{}".format(file)14)1589280抖0抖1抖2抖3抖4抖5抖6抖7#8create9the10commit11data12file1390280抖0抖1抖2抖3抖4抖5抖6抖7commit_data_file8=9open(self.location10+11"/prt/{}.commit".format(file_name),12"w")1391180抖0抖1抖2抖3抖4抖5抖6抖7commit_data_file.close()892220抖0抖1抖2抖3抖4抖5抖6抖7os.remove(self.location8+9"/{}.old".format(file_name))1093180抖0抖1抖2抖3抖4抖5抖6抖7抖894300抖0抖1抖2抖3抖4抖5抖6抖7ft.write_commit(self.location8+9"/prt/{}.commit".format(file_name),10commit_data,11commit_number,12"Initial13commit")1495009660cmt0=1prt_commit()2Initial commit
1000100200300400500600700800900100011001200130014001500160017001800190020002100220023002400250026002700280029003000310032003300340035003600370038003900400041004200430044004500460047004800490050005100520053005400550056005700580059006000610062006300640065006600670068006900700071007200730074007500760077007800790080008100820083008400850086008700880089009000910092009300940095009600Untitled Commit
